*(a.k.a. Royal Pain in the Ass Edition)*

Andrew G. Stanton - Sept. 6, 2025

## What NIP-05 is *supposed* to be
Just a simple way to prove that `user@domain` belongs to a Nostr pubkey.

## What it’s actually like
A gauntlet of DNS quirks, headers, caches, and client inconsistencies.  
If you’re doing this sovereign (not outsourcing to Alby, nostrplebs, etc.), prepare for some pain.

---

## 1. DNS Setup
- Point your domain to Cloudflare (or another host where you can control headers).
- For GitHub Pages, use the four official A records:
  - 185.199.108.153  
  - 185.199.109.153  
  - 185.199.110.153  
  - 185.199.111.153
- Kill any stray NS records (don’t let GoDaddy defaults linger).
- Expect propagation to take **hours**, not minutes.

**Check:**
```bash
dig NS yourdomain.xyz +short
# should return only cloudflare nameservers
```

---

## 2. JSON File
Your file must live at:

```
https://yourdomain.xyz/.well-known/nostr.json
```

### Example
```json
{
  "names": {
    "alice": "64charhexpubkey",
    "bob":   "64charhexpubkey"
  }
}
```

### Rules
- Keys = lowercase usernames (must exactly match the `nip05` you claim in your profile).
- Values = **64-character lowercase hex pubkey** (not npub).
- No trailing commas.
- No BOM (file must start with `{`).

**Check:**
```bash
curl -s https://yourdomain.xyz/.well-known/nostr.json | jq .
curl -s https://yourdomain.xyz/.well-known/nostr.json   | jq -r '.names | to_entries[] | "\(.key) \(.value)"'   | awk '{print $1, length($2)}'
# every value should be 64
```

---

## 3. Headers (CORS Hell)
Browsers won’t even parse the file without:

```
Access-Control-Allow-Origin: *
```

Also good to add:

```
Content-Type: application/json; charset=utf-8
Cache-Control: max-age=300, public
```

If you’re using GitHub Pages, add these with Cloudflare “Response Header Rules”:

- Rule 1: **Remove** `Access-Control-Allow-Origin`
- Rule 2: **Add** a single `Access-Control-Allow-Origin: *`  
  (plus `Content-Type` and `Cache-Control`)

**Check:**
```bash
curl -sI "https://yourdomain.xyz/.well-known/nostr.json?ts=$(date +%s)" | grep -i access-control-allow-origin
# should show exactly one line
```

---

## 4. Relay + Client Caches
Even after you fix the file:
- Primal web may cache a failed verification until you **re-publish kind:0 metadata**.
- Mobile vs web clients check differently (mobile often server-side).
- Coracle is notorious for stale cache.

**Force refresh:**
- Edit your profile metadata twice (make a tiny change each time).
- Save → publish a new kind:0 with updated `created_at`.
- Then hard-reload in incognito.

---

## 5. Verification Matrix
✅ A checkmark appears when:
1. Your profile metadata includes `nip05: "name@yourdomain.xyz"`.
2. The JSON file includes `"name": "<64-char-hex>"`.
3. The hex matches your pubkey.
4. The file is served with proper headers.

**Cross-check with:**
- [Primal](https://primal.net)  
- [Snort](https://snort.social)  
- [Coracle](https://coracle.social)

If it shows in 2/3, you’re good; the last is just cache lag.

---

## Final Thoughts
> “NIP-05 is simple” is only true if you outsource it.  
> If you’re doing it sovereign, expect some frustration.  
> But once it works, you’ll never have to touch it again.  
> And you’ll know you actually own it.

---

## Acknowledgement

This article was drafted with the help of Dr. C - ChatGPT (GPT-5), which I use as a co-writer and collaborator in developing ideas around sovereignty, Bitcoin, decentralization, and theology.

## Zaps Appreciated

If this resonates, consider sending a zap. Every zap is an act of sovereign support — no middlemen, no gatekeepers, just direct proof that this work matters. It helps me keep building Continuum and writing about sovereign technology, freely and without VC overhead. Thank you.

You can send zaps to my lightning address here: andrewgstanton@primal.net